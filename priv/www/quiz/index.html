<!doctype html>
<html lang="sv">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>jaktpass (Quiz)</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div class="app">
      <header class="top">
        <div class="brand" id="brand">Jaktpass</div>
        <nav class="tabs">
          <button id="tab-admin" class="tab">Admin</button>
          <button id="tab-quiz" class="tab">Quiz</button>
          <button id="logout-btn" class="tab" style="display:none">Logga ut</button>
        </nav>
      </header>

      <main>
        <section id="view-admin" class="view">
          <h2>Admin</h2>

          <div id="admin-only">
          <div class="card">
            <h3>Set</h3>
            <div class="row">
              <label>Namn <input id="new-set-name" type="text" placeholder="t.ex. Södra jaktmarken" /></label>
              <button id="create-set">Skapa set</button>
            </div>
            <div class="row">
              <label>Välj set
                <select id="admin-set-select"></select>
              </label>
              <button id="refresh-admin">Uppdatera</button>
              <button id="delete-set" class="danger">Radera set</button>
            </div>
            <pre id="admin-set-meta" class="pre"></pre>
          </div>

          <div class="card">
            <h3>Ladda upp kartbild</h3>
            <div class="row">
              <input id="image-file" type="file" accept=".png,.jpg,.jpeg,.webp,image/png,image/jpeg,image/webp" />
              <button id="upload-image">Ladda upp</button>
            </div>
          </div>

          <div class="split">
            <div class="card">
              <h3>Pass (stands)</h3>
              <div class="hint">Klicka i bilden för att fylla x/y (normaliserat). Skapa sedan stand.</div>
              <div class="row">
                <label>Namn <input id="stand-name" type="text" /></label>
                <label>X <input id="stand-x" type="number" step="0.0001" min="0" max="1" /></label>
                <label>Y <input id="stand-y" type="number" step="0.0001" min="0" max="1" /></label>
                <button id="create-stand">Skapa</button>
              </div>
              <div class="row">
                <label>Note <input id="stand-note" type="text" /></label>
              </div>
              <div class="row">
                <label>Vald standId <input id="selected-stand-id" type="text" readonly /></label>
                <button id="delete-stand">Radera vald</button>
              </div>
              <div class="hint">För att flytta: välj stand i listan → klicka ny position i bilden → klicka “Uppdatera vald”.</div>
              <div class="row">
                <button id="patch-stand">Uppdatera vald</button>
              </div>
              <ul id="stands-list" class="list"></ul>
            </div>
          </div>

          <div class="card">
            <h3>Karta</h3>
            <div id="admin-map" class="map"></div>
          </div>
          </div>
        </section>

        <section id="view-quiz" class="view">
          <h2 id="quiz-title">Quiz</h2>
          <div id="quiz-home" class="card">
            <div class="row">
              <div class="pill">Quiz-typ:</div>
              <div class="segmented" role="group" aria-label="Quiz-typ">
                <button id="mode-rand10" class="seg-btn">10 pass</button>
                <button id="mode-randHalf" class="seg-btn">Hälften</button>
                <button id="mode-all" class="seg-btn">Alla</button>
              </div>
            </div>
            <div class="hint">Välj hur många pass du vill köra, välj sedan ett set och tryck Start.</div>
            <div id="quiz-set-list" class="set-list"></div>
          </div>

          <div id="quiz-play" style="display:none">
            <div class="card">
              <div class="row">
                <div class="quiz-head">
                  <div class="quiz-question">Hitta: <span id="quiz-question">-</span></div>
                  <div class="quiz-instr">Klicka på rätt prick på kartan. Alla prickar är pass.</div>
                </div>
                <button id="quiz-back" class="secondary" style="margin-left:auto">Avsluta</button>
              </div>
            </div>

            <div class="card">
              <h3>Karta</h3>
              <div id="quiz-map" class="map"></div>
              <div class="row" style="margin-top:10px">
                <div class="pill">Progress: <span id="quiz-progress">0/0</span></div>
                <div class="pill">Score: <span id="quiz-score">100%</span></div>
              </div>
            </div>

            <!-- Debug-json borttaget i quiz-läget -->
            <pre id="quiz-debug" class="pre" style="display:none"></pre>
          </div>
        </section>
      </main>
    </div>

    <!-- Login-modal för /admin -->
    <div id="login-modal" class="modal" style="display:none" aria-hidden="true">
      <div class="modal-backdrop"></div>
      <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="login-title">
        <h3 id="login-title">Logga in</h3>
        <div class="hint">Admin kräver Basic Auth. Ange username/password och klicka Logga in.</div>
        <div class="row" style="margin-top:10px">
          <label>Username <input id="login-user" type="text" autocomplete="username" /></label>
          <label>Password <input id="login-pass" type="password" autocomplete="current-password" /></label>
        </div>
        <div class="row" style="margin-top:10px">
          <button id="login-submit">Logga in</button>
          <button id="login-cancel" class="secondary">Avbryt</button>
        </div>
      </div>
    </div>

    <!-- Slut-modal för quiz -->
    <div id="quiz-finish-modal" class="modal" style="display:none" aria-hidden="true">
      <div class="modal-backdrop"></div>
      <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="finish-title">
        <h3 id="finish-title">Klart!</h3>
        <div class="hint">Din score: <b><span id="finish-score">0%</span></b></div>
        <div class="card" style="margin-top:12px">
          <div class="row">
            <label>Namn
              <input id="finish-name" type="text" placeholder="Ditt namn" />
            </label>
            <button id="finish-save">Spara till topplistan</button>
          </div>
          <div class="hint" style="margin-top:8px">Topplista (för detta set och vald quiz-typ):</div>
          <ol id="finish-leaderboard" class="list"></ol>
        </div>
        <div class="row" style="margin-top:10px">
          <button id="finish-restart">Starta om</button>
          <button id="finish-to-list" class="secondary">Avsluta</button>
        </div>
      </div>
    </div>

    <script src="/app.js"></script>
  </body>
</html>


